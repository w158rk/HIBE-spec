
## 数据结构

### 主公钥文件结构

| 字段 | 描述 | 大小(字节) |
|-----|------|------|
| 标识 | 0x30 | 1 |
| length | 0x81, 0xea (234字节)| 2 |
| pairing | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x06,0x01 (so[7633]) | 12 |
| scheme | 0x06, 0x09, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x03 (so[7597]) | 11 |
| hash1 | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x04,0x01 (so[7693]) | 12 |
| pointPpub1 | 0x04, 0x41, $G_1$上的点，65位 | 67 |
| pointPpub2 | 0x04, 0x81, 0x81, $G_2$上的点， 129位 | 132 |

所以一个主公钥文件的大小是固定的：237字节

### 主私钥文件结构

| 字段 | 描述 | 大小(字节) |
|-----|------|------|
| 标识 | 0x30 | 1 |
| length | 0x82, 0x01, 0x0c (268字节) | 3 |
| pairing | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x06,0x01 (so[7633]) | 12 |
| scheme | 0x06, 0x09, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x03 (so[7597]) | 11 |
| hash1 | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x04,0x01 (so[7693]) | 12 |
| pointPpub1 | 0x04, 0x41(65字节), $G_1$上的点 | 67 |
| pointPpub2 | 0x04, 0x81, 0x81(129字节), $G_2$上的点 | 132 |
| masterSecret | 0x02, 0x20(32字节), $F_p$上的数 | 34 |

一个主私钥文件的大小是固定的：272字节


### 私钥文件结构 

| 字段 | 描述 | 大小(字节) |
|-----|------|------|
| 标识 | 0x30 | 1 |
| length | 0x82, 0x01, 0x79 (277字节) | 3 |
| pairing | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x06,0x01 (so[7633]) | 12 |
| scheme | 0x06, 0x09, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x03 (so[7597]) | 11 |
| hash1 | 0x06, 0x0A, 0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2E,0x04,0x01 (so[7693]) | 12 |
| pointPpub1 | 0x04, 0x41(65字节), $G_1$上的点 | 67 |
| pointPpub2 | 0x04, 0x81, 0x81(129字节), $G_2$上的点 | 132 |
| identity | 0x04, 长度+ID | 长度不定 |
| publicPoint | 0x04, 0x41(65字节), $G_1$上的点 | 67 |
| privatePoint | 0x04, 0x41(65字节), $G_1$上的点 | 67 |

一个私钥文件的大小与ID相关，对于长度小于128字节的ID，私钥文件大小为：ID长度+374

### 证书文件结构

### 标识库结构 

标识库存储一个KGC管理的所有节点标识，数据表项具有如下结构：

| 字段 | 描述 |
|-----|------|
| serial number | 在该数据库中唯一标识该表项，功能上相当于数据库主键 |
| nid | 节点标识 |
| secret | 用于未来恢复私钥的秘密问题 |
| status | 一些需要额外保留的状态信息 |


### 证书库结构 

证书库存储一个证书管理机构管理的所有整数，数据表项具有如下结构：

| 字段 | 描述 |
|------|------|
| serial number | 在该数据库中唯一标识该表项，功能上相当于数据库逐渐 |
| nid | 该证书颁发对象的标识，与证书文件中的`aud`字段相对应 |
| cert | 证书，可以是证书原文，或证书的某些关键字段 |
| nbf | 证书生效时间，与证书中的`nbf`字段相对应 |
| exp | 证书过期时间，与证书中的`exp`字段相对应 |
| status | 一些需要额外保留的状态信息 |


### 撤销列表结构 

标识和证书的撤销列表都是相同的，具有如下结构：

| 字段 | 描述 |
|------|------|
| serial number | 证书/标识库的serial number，实现上可以使用数据库外键 |
| revoke time | 撤销时间 |
